---
title: Creating iOS Icon Masks on the Web
date: 2017-11-08
tags: engineering tips
---

For some time I’ve been maintaining [iOS Icon Gallery](http://iosicongallery.com), a site dedicated to showcasing great icon designs for iOS. This post is a look at just one piece of engineering that site: mimicking the iOS-style rounded icons.

## The Problem

The icons in iOS are pretty iconic in their shape. Just look at the silhoutte of one and you’ll probably think “iPhone”:

![iOS icon silhouette]({{ site.imageurl }}/2017/iosicons-silhouette.png)

In iOS, all icons must conform to this shape. This is in contrast to Android, for example, where your icon can take whatever shape you want (while having transparency or not having transparency, up to you). Hence, when you’re creating an icon for iOS it’s not a blank canvas, there are constraints like a lack of transparency and a requirement for square artwork.

The shape of the icon’s mask is defined at the system level and applied automatically by iOS. So the actual image file submitted by app developers is just a square image and the corners are masked by iOS.

![iOS icon with and without mask]({{ site.imageurl }}/2017/iosicons-icon-with-and-without-mask)

What if you’re displaying an iOS icon on the web? Creating this same effect on has got to be easy right? ... RIGHT?! I have three words for you: cross-browser support.

So if you want to display a bunch of iOS icons on the web how would you do it?

Well, a good place to start would be to see how Apple does it. If you look up an app preview in iTunes Preview (let’s say [Angry Birds](https://itunes.apple.com/us/app/angry-birds/id343200656?mt=8)) and open the browser’s dev tools, you can see how Apple displays iOS icon artwork using web technologies.

So how do they do it? Each icon is merely an `<img>` tag. Adjacent to the image tag, there’s a `<span class="mask">` tag which leverages CSS to load and position another image, which acts as a mask, on top of the icon. Try removing the mask and all you’ll see is the square icon.

![Masking an image in HTML/CSS]({{ site.imageurl }}/2017/iosicons-itunes-preview.gif)

If you look closely at the `<span class="mask">` and it’s background image, you’ll see it has three distinct pieces:

1. A transparent area in the shape of the iOS mask
2. An opaque white background outside the area of the transparent mask
3. A 1px, semi-transparent, inner border around the mask shape

![Anatomy of an iOS icon mask]({{ site.imageurl }}/2017/iosicons-mask-anatomy.png)

The reason you need the 1px border is because some icons have white backgrounds. So, if you did’t have a border in the shape of the iOS mask, you wouldn’t get that iconic iOS shape around the image.

![Need for a border]({{ site.imageurl }}/2017/iosicons-border-need.gif "Note how when the mask is removed, the icon doesn’t have any shape.)

Meanwhile, for icons that aren’t on a pure white background, you still get a nice aesthetic on the border which can be perceived at different levels depending on how dark the colors of the underlying icon are.

![Border comparison]({{ site.imageurl }}/2017/iosicons-inner-border-comparison.png "Note the semi-transparent border which blends in to the underlying icon at varying degrees, depending on the color.)




















This has allowed Apple to make programmatic refinements and tweaks to how icons are displayed over time. For example, pre-iOS7, icons used to have a mask as well an (optional) highlight applied by the operating system:

![Pre iOS7 icon example]({{ site.imageurl }}/2017/iosicons-early-versions-ios.png)

When iOS 7 came along, the mask of the icons was slightly tweaked (more on this later, image courtesy of [manbolo blog](http://blog.manbolo.com/2013/08/15/new-metrics-for-ios-7-app-icons)):

![Diff between iOS6 and iOS7 icons]({{ site.imageurl }}/2017/iosicons-early-versions-ios.png)




## Code review for iOS masking

### Things to have ready:
- [ ] [codepen](https://codepen.io/jimniels/pen/OxbEyN?editors=1100)
- [ ] localhost version with modal overlay
- [ ] Site open without masks
- [ ] VSCode

### The Problem

- iOS images are not rounded by default. Artwork from developers is square. iOS provides the outlines at the system level.
- Creating the same effect on the web has got to be easy right? RIGHT?! 
	- PLAY TIME IN BROWSER
		- http://iosicongallery.com (remove mask and apply border)
		- Slap on `border` and `border-radius`
			- `border` applies outside the element, but I want it inside
		- It’s a site for designers k guys? Gotta be on MY GAME
	- Pre iOS 7 this would’ve worked
		- Slap a border radius on there conforming to Apple’s standards
			- `border-radius` wasn’t supported back then, so I still had to use images the way I’m doing now (see further below)
	- Post iOS 7 this doesn’t work
		- The [“squircle”](https://applypixels.com/the-hunt-for-the-squircle/) instead of a rounded rectangle (before apple gave us an official template)
		- “[Curvature continuity](https://hackernoon.com/apples-icons-have-that-shape-for-a-very-good-reason-720d4e7c8a14)” between hardware and software
- How it’s done now
	- Pseudo-element PNG images, in a variety of sizes/resolutions, that mask corners
	- Don’t forget the 1px border for icons on white
- Why I’m changing (goals)
	- True image masking
		- Want to get rid of square corners so I can have fully transparent mask (see new modal example)
	- Pixel agnostic
		- No need to create @1x, @2x, @3x images
	- More semantic markup

### The Solution 

- Attempted solutions
	- Start applying a mask when I save the image
		- Nah.
	- `border` & `border-radius`
		- Not good enough (picky designers, 1px differences is what they do for a living)
		- But good enough as a “graceful-degradation” fallback (you a designer on a retina screen but you use IE9? Forget you)
	- `clip-path: url(#file.svg)`
		- Responsive-ness doesn’t work
			- `objectBoundingBox` fixes this, but but you gotta resize the svg to be 1x1 pixel
		- Browser support
			- Works relatively well for SVG elements, not so much for HTML elements
			- Even modernizr doesn’t feature detect it working for HTML (i.e.  `<img>` ) elements. 
	- `mask-image:  url(#file.svg)`
		- Pixel agnostic? Check
		- True image masking? Check
		- Graceful degradation? Check
			- Use `@supports`
		- Semantic markup? Not quite. Need a wrapper.
			- `<span class=“icon-wrapper”><img /></span>`